# centos7安装nginx-1.20.1

## 1.安装依赖

```
yum -y install gcc pcre pcre-devel zlib zlib-devel openssl openssl-devel
```

> - gcc linux编译器
> - pcre是一个perl库，包括perl兼容的正则表达式库，nginx的http模块使用pcre来解析正则表达式
> - zlib库提供了很多种压缩和解压缩方式nginx使用zlib对http包的内容进行gzip
> - openssl是web安全通信的基石，也就是https相关的依赖

## 2.下载解压nginx

```
# 下载nginx-1.20.1
wget http://nginx.org/download/nginx-1.20.1.tar.gz

# 解压缩nginx-1.20.1，nginx被解压到了/usr/local/nginx-1.20.1 目录下（不要把压缩包解压到/usr/local/nginx目录下，或者将解压后的目录重命名为nginx，因为nginx会默认安装到/usr/local/nginx目录下），切换到nginx-1.20.1/目录
tar -zxvf nginx-1.20.1.tar.gz

```

## 3.编译安装

```
# 进入解压后的目录nginx-1.20.1
cd nginx-1.20.1

#进行编译安装
./configure
make
make install
#无报错则安装完成
```

## 4.启动ngnix

```
#默认安装目录为/usr/lcoal/nginx，进入该目录
cd /usr/lcoal/nginx

#启动之前先看一下有没有nginx的进程在运行，nginx默认80端口，看看80端口有没有被占用

# 查看当前有无nginx相关的进程在运行
ps aux | grep -v grep | grep nginx

# 看看80端口有没有被占用
netstat -tunlp | grep 80


#进入/usr/lcoal/nginx/sbin目录，启动nginx
# 启动nginx
./nginx

#如无任何信息输出，说明启动成功，此时再查看一次有无ngixn的进程？80端口有没有被占用？


```

![img](https://i.loli.net/2021/11/25/UrGadPbJDQHNhzB.png)

如上图可见，启动之后 确实有nginx的进程信息，80端口也被nginx占用，确实启动成功

用IP访问成功，出现nginx欢迎页面。

![img](https://i.loli.net/2021/11/25/87hHUawqNlpGFtQ.png)

- 设置开机启动

  ```
  # 1.切换到/lib/systemd/system/目录，创建nginx.service文件vim nginx.service
  cd /lib/systemd/system/
  vim nginx.service
  
  # 2.文件内容如下：
  [Unit]
  Description=nginx 
  After=network.target 
     
  [Service] 
  Type=forking 
  ExecStart= /usr/local/nginx/sbin/nginx
  ExecReload= /usr/local/nginx/sbin/nginx  reload
  ExecStop= /usr/local/nginx/sbin/nginx  quit
  PrivateTmp= true 
     
  [Install] 
  WantedBy=multi-user.target
  
  # 3.退出并保存文件，执行systemctl enable nginx.service使nginx开机启动
  systemctl enable nginx.service
  ```

  

## 5.停止和重启

```
#温和停止,处理完当前的任务再停止
nginx -s quit
#强制立即停止
nginx -s stop

#平滑重启,不关闭nginx服务,重新加载配置文件，重新启动
nginx -s reload   
```



---------------------------------------------



## 启动、结束、重启命令

```
systemctl start nginx.service    启动nginx

systemctl stop nginx.service    结束nginx

systemctl restart nginx.service    重启nginx
```

